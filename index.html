<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sonar Rock - La Radio Independiente</title>

<!-- CSS -->
<link href="style.css" rel="stylesheet">
<link href="player.css" rel="stylesheet">

<!-- Iconos -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

<!-- PWA & Favicons -->
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#ff6600">
<link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
<link rel="shortcut icon" href="/icons/favicon.ico">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="google" content="notranslate">

<style>
@media(max-width:560px){
  .disco-section #cover{
    width:90px !important;
    height:90px !important;
    border-radius:10px;
  }
}
.section-title{
  color:#FF6600 !important;
  font-family: "Spotify Circular", Arial, sans-serif;
}
</style>
</head>
<body>

<!-- Header -->
<header class="header">
  <div class="container">
    <div class="logo-section">
      <img src="attached_assets/logo_1749601460841.jpeg" alt="Sonar Rock Logo" class="logo">
      <div class="title-section">
        <h1>LA RADIO INDEPENDIENTE</h1>
      </div>
    </div>
  </div>
</header>

<!-- Imagen Principal -->
<section class="main-section">
  <div class="container">
    <div class="main-image-container">
      <img src="attached_assets/sonarrock.png" alt="Sonar Rock" class="main-image" style="max-width:1220px; width:100%;">
    </div>
  </div>
</section>

<!-- REPRODUCTOR STREAMING -->
<section class="player-section">
  <div class="player-container">
    <img src="img/background1.png" alt="Background" class="player-bg">
    <canvas id="matrixCanvas"></canvas>
    <div class="overlay"></div>
    <div class="player-content">
      <div id="now-playing"></div>
      <div class="controls">
        <button id="playPauseBtn" class="btn"><i class="fas fa-play"></i></button>
        <button id="stop-btn" class="btn"><i class="fas fa-stop"></i></button>
        <button id="mute-btn" class="btn"><i class="fas fa-volume-up"></i></button>
      </div>
      <div class="progress-wrapper">
        <div id="radio-progress-container" class="progress-container">
          <div id="radio-progress"></div>
        </div>
        <div id="time-display" class="time-display">00:00:00</div>
      </div>
      <audio id="radio-audio" preload="auto">
        <source src="https://stream.zeno.fm/ezq3fcuf5ehvv" type="audio/mpeg">
      </audio>
    </div>
  </div>
</section>

<!-- Disco de la Semana -->
<h2 class="section-title" style="margin-top:60px; margin-bottom:40px;">El Disco de la Semana</h2>
<section class="disco-section" style="margin-top:50px; display:flex; align-items:center; gap:15px;">
  <div class="container" style="display:flex; align-items:center; gap:15px;">
    <img id="cover" src="El Disco De La Semana/portada.jpg" alt="Portada" style="width:120px; height:120px; border-radius:12px; box-shadow:0 0 10px rgba(255,102,0,0.6); transition: transform 0.2s, box-shadow 0.2s;">
    <div style="flex:1; display:flex; flex-direction:column; gap:5px;">
      <div id="track-title" style="color:#FFFFFF; font-weight:bold; font-size:1.1rem;">Título del Disco</div>
      <div id="disco-progress-container" class="progress-container">
        <div id="disco-progress"></div>
      </div>
      <audio id="disco-audio" preload="auto" controls style="margin-top:5px;"></audio>
    </div>
  </div>
</section>

<!-- iVoox & Spotify -->
<section class="embed-section" style="margin-top:60px;">
  <div class="container" style="max-width: 650px; margin: auto;">
    <h3 class="section-title" style="margin-bottom:40px;">Escucha en Spotify</h3>
    <iframe
      src="https://open.spotify.com/embed/show/6mPcjQLeDdCwxzJe3PLlyU?si=TiadCqdlRCyd97QygWQWfA"
      width="100%"
      height="170"
      frameborder="0"
      allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
      loading="lazy"
      style="border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.6);">
    </iframe>

    <h3 class="section-title" style="margin:40px 0 25px;">Escucha en iVoox</h3>
    <div id="podcast-player" class="player-wrapper"></div>
  </div>
</section>

<!-- JS FINAL -->
<script>
document.addEventListener('DOMContentLoaded', function () {

  // --- STREAMING ZENO ---
  const playPauseBtn = document.getElementById('playPauseBtn');
  const stopBtn = document.getElementById('stop-btn');
  const muteBtn = document.getElementById('mute-btn');
  const audio = document.getElementById('radio-audio');
  const progress = document.getElementById('radio-progress');
  const progressContainer = document.getElementById('radio-progress-container');
  const timeDisplay = document.getElementById('time-display');
  let animationRunning = false;
  let animationFrame;

  playPauseBtn.addEventListener("click", ()=>{
    if(audio.paused){
      audio.play().then(()=>{ playPauseBtn.innerHTML='<i class="fas fa-pause"></i>'; startMatrix(); })
      .catch(err=>{ console.warn("Autoplay bloqueado", err); });
    } else {
      audio.pause(); playPauseBtn.innerHTML='<i class="fas fa-play"></i>'; stopMatrix();
    }
  });

  stopBtn.addEventListener("click", ()=>{
    audio.pause(); audio.currentTime=0; playPauseBtn.innerHTML='<i class="fas fa-play"></i>'; stopMatrix();
  });

  muteBtn.addEventListener("click", ()=>{
    audio.muted=!audio.muted;
    muteBtn.innerHTML = audio.muted?'<i class="fas fa-volume-mute"></i>':'<i class="fas fa-volume-up"></i>';
    muteBtn.style.color = audio.muted?'#ff0000':'#ff6600';
  });

  audio.addEventListener("timeupdate", ()=>{
    if(audio.duration){ progress.style.width=(audio.currentTime/audio.duration*100)+'%'; }
    const h=Math.floor(audio.currentTime/3600), m=Math.floor((audio.currentTime%3600)/60), s=Math.floor(audio.currentTime%60);
    timeDisplay.textContent = `${h.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`;
  });

  progressContainer.addEventListener("click",(e)=>{
    const rect=progressContainer.getBoundingClientRect();
    audio.currentTime=((e.clientX-rect.left)/rect.width)*audio.duration;
  });

  // --- MATRIX ---
  const canvas=document.getElementById("matrixCanvas");
  const ctx=canvas.getContext("2d");
  let columns, drops, fontSize=16;
  function resizeCanvas(){ canvas.width=canvas.offsetWidth; canvas.height=canvas.offsetHeight; columns=Math.floor(canvas.width/fontSize); drops=Array(columns).fill(1);}
  window.addEventListener("resize", resizeCanvas); resizeCanvas();
  const chars="アァイィウヴエェオカガキギクグケゲコゴabcdefghijklmnopqrstuvwxyz0123456789".split("");
  function drawMatrix(){ ctx.fillStyle="rgba(0,0,0,0.1)"; ctx.fillRect(0,0,canvas.width,canvas.height); ctx.font=fontSize+"px monospace"; for(let i=0;i<drops.length;i++){ const text=chars[Math.floor(Math.random()*chars.length)]; const x=i*fontSize; const y=drops[i]*fontSize; ctx.fillStyle="rgba(0,255,0,1)"; ctx.fillText(text,x,y); ctx.fillStyle="rgba(0,255,0,0.5)"; ctx.fillText(text,x,y-fontSize); if(y>canvas.height && Math.random()>0.975){ drops[i]=0; } drops[i]++; } animationFrame=requestAnimationFrame(drawMatrix);}
  function startMatrix(){ if(!animationRunning){ animationRunning=true; drawMatrix(); } }
  function stopMatrix(){ if(animationRunning){ cancelAnimationFrame(animationFrame); animationRunning=false; ctx.clearRect(0,0,canvas.width,canvas.height); }}

  // --- DISCO DE LA SEMANA ---
  const fileName="Bob Dylan - The Times They Are A-Changin'.mp3";
  const discoAudio=document.getElementById("disco-audio");
  const discoProgress=document.getElementById("disco-progress");
  const discoProgressContainer=document.getElementById("disco-progress-container");
  const trackTitle=document.getElementById("track-title");
  const cover=document.getElementById("cover");
  trackTitle.textContent=fileName.replace(/\.mp3$/i,'');

  fetch(`https://raw.githubusercontent.com/sonarrock/web/main/El%20Disco%20De%20La%20Semana/${encodeURIComponent(fileName)}`)
    .then(r=>{ if(!r.ok)throw new Error("No se pudo descargar el MP3"); return r.blob(); })
    .then(blob=>{ discoAudio.src=URL.createObjectURL(blob); })
    .catch(err=>{ console.error(err); trackTitle.textContent="Error: disco no encontrado"; });

  discoAudio.addEventListener('timeupdate', ()=>{ if(discoAudio.duration){ discoProgress.style.width=(discoAudio.currentTime/discoAudio.duration*100)+'%'; } });
  discoProgressContainer.addEventListener('click',(e)=>{ const rect=discoProgressContainer.getBoundingClientRect(); discoAudio.currentTime=((e.clientX-rect.left)/rect.width)*discoAudio.duration; });

  // Animación portada
  let zoomDirection=1, zoomInterval;
  discoAudio.addEventListener('play', ()=>{ zoomInterval=setInterval(()=>{ let scale=parseFloat(cover.style.transform.replace(/[^\d.]/g,''))||1; scale+=0.0015*zoomDirection; if(scale>=1.03)zoomDirection=-1; if(scale<=0.97)zoomDirection=1; cover.style.transform=`scale(${scale})`; const shadowIntensity=10+(scale-0.97)*300; cover.style.boxShadow=`0 0 ${shadowIntensity}px rgba(255,102,0,0.6)`; },20); });
  discoAudio.addEventListener('pause', ()=>{ clearInterval(zoomInterval); cover.style.transform='scale(1)'; cover.style.boxShadow='none'; });
  discoAudio.addEventListener('ended', ()=>{ clearInterval(zoomInterval); cover.style.transform='scale(1)'; cover.style.boxShadow='none'; });

  // --- iVoox ---
  async function loadLatestIvooxEpisode(){
    const feedUrl="https://corsproxy.io/?https://www.ivoox.com/feed_fg_f12661206_filtro_1.xml";
    try{
      const response=await fetch(feedUrl);
      const xmlText=await response.text();
      const parser=new DOMParser();
      const xml=parser.parseFromString(xmlText,"text/xml");
      const item=xml.querySelector("item");
      if(!item)throw new Error("No se encontró ningún episodio");
      const title=item.querySelector("title").textContent;
      const audioUrl=item.querySelector("enclosure").getAttribute("url");
      const pubDate=new Date(item.querySelector("pubDate").textContent).toLocaleDateString();
      const imageUrl=item.querySelector("itunes\\:image, image")?.getAttribute("href")||"https://static-1.ivoox.com/img/podcast_default.jpg";
      const playerHTML=`<div><img src="${imageUrl}" alt="Carátula episodio" /><div style="flex:1;"><h3>${title}</h3><p>Publicado el ${pubDate}</p><audio controls preload="none"><source src="${audioUrl}" type="audio/mpeg" />Tu navegador no soporta audio HTML5.</audio></div></div>`;
      document.getElementById("podcast-player").innerHTML=playerHTML;
    }catch(err){ document.getElementById("podcast-player").innerHTML=`<p style="color:#f00;">No se pudo cargar el reproductor. Intenta más tarde.</p>`; console.error(err); }
  }
  loadLatestIvooxEpisode();

<!-- ========================= -->
<!-- STAFF -->
<!-- ========================= -->
<section class="staff-section">
  <div class="container">
    <h2 class="section-title" style="margin-bottom:40px;">Staff</h2>
    <div class="staff-grid">
      <div class="staff-member">
        <img src="attached_assets/Wendy_1749601460841.jpeg" alt="Wendy" class="staff-image">
        <h3>Wendy</h3>
      </div>
      <div class="staff-member">
        <img src="attached_assets/Alvaro_1749601460841.jpeg" alt="Alvaro" class="staff-image">
        <h3>El Contralor</h3>
      </div>
      <div class="staff-member">
        <img src="attached_assets/Hans_1749601460841.jpeg" alt="Hans" class="staff-image">
        <h3>Hans</h3>
      </div>
      <div class="staff-member">
        <img src="attached_assets/El Chris_1749601460841.jpeg" alt="El Chris" class="staff-image">
        <h3>El Chris</h3>
      </div>
    </div>
  </div>
</section>

<!-- ========================= -->
<!-- ¿QUIÉNES SOMOS? -->
<!-- ========================= -->
<section class="about-section">
  <div class="container">
    <div class="about-content">
      <h2 class="section-title">¿Quiénes Somos?</h2>
      <p class="about-text">
        Sonar Rock es una trinchera sonora, un espacio libre y apasionado que nace en Guadalajara, Jalisco, México.
        Nuestra misión es simple pero poderosa: abrir un foro auténtico para las bandas emergentes, apoyar la escena local y mantener viva la esencia del rock en todas sus vertientes.

        Creemos en la fuerza de la música como motor de cambio, como punto de encuentro y como refugio de quienes buscan algo distinto a lo convencional.
        En Sonar Rock somos más que una radio: somos comunidad, resistencia y pasión por el sonido que nos une.
      </p>
    </div>
  </div>
</section>

<!-- ========================= -->
<!-- ¿QUÉ ES SONAR ROCK? -->
<!-- ========================= -->
<section class="about-section">
  <div class="container">
    <div class="about-content">
      <h2 class="section-title">¿Qué es Sonar Rock?</h2>
      <p class="about-text">
        Sonar Rock celebra la esencia eterna del rock n’ roll:

        Su rebeldía frente a lo establecido.

        Su poesía en cada letra y acorde.

        Su energía que enciende escenarios y corazones.

        Su capacidad de conectar almas más allá de fronteras y generaciones.

        Aquí el rock no se escucha de fondo, se vive. Somos un canal donde conviven lo clásico, lo alternativo y lo emergente, siempre con la autenticidad como bandera.
      </p>
    </div>
  </div>
</section>

  
});
</script>

</body>
</html>
